#lang racket

(require rackunit "file.rkt")

(check-equal? all (set 1 2 3 4 5 6 7 8 9) "Test all")
(check-equal? (tile-solved? all) #f "Testing that more that one option returns not solved")
(check-equal? (tile-solved? (set 3)) #t "Testing singleton returns solved")


(check-equal? (transform (list (list 1 2 0) (list 0 5 0) (list 7 0 9))) 
              (list (list (set 1) (set 2) (set 1 2 3 4 5 6 7 8 9))
                    (list (set 1 2 3 4 5 6 7 8 9) (set 5) (set 1 2 3 4 5 6 7 8 9))
                    (list (set 7) (set 1 2 3 4 5 6 7 8 9) (set 9)))
              "Testing transforming small grid into nest lists of sets")

(check-equal? (transformflat (list (list 1 2 0) (list 0 5 0) (list 7 0 9))) 
              (list (set 1) (set 2) (set 1 2 3 4 5 6 7 8 9)
                    (set 1 2 3 4 5 6 7 8 9) (set 5) (set 1 2 3 4 5 6 7 8 9)
                    (set 7) (set 1 2 3 4 5 6 7 8 9) (set 9))
              "Testing transforming small grid into flat list of sets")

(check-equal? (get-row 80) 8 "Testing tile 80 is in row 8")
(check-equal? (get-row 54) 6 "Testing tile 54 is in row 6")
(check-equal? (get-row 4) 0 "Testing tile 4 is in row 0")

(check-equal? (get-col 80) 8 "Testing tile 80 is in col 8")
(check-equal? (get-col 54) 0 "Testing tile 55 is in col 0")
(check-equal? (get-col 4) 4 "Testing tile 4 is in col 4")

(check-equal? (get-box 80) 8 "Testing tile 80 is in box 8")
(check-equal? (get-box 54) 6 "Testing tile 55 is in box 6")
(check-equal? (get-box 4) 1 "Testing tile 4 is in box 1")

(check-equal? (make-tile 0 54) (tile 6 0 6 all) "Testing make tile deals with 0")
(check-equal? (make-tile 3 4) (tile 0 4 1 (set 3)) "Testing make tile deals with values")

(check-equal? (transform-tile (test-board)) (list
 (tile 0 0 0 (set 1 2 3 4 5 6 7 8 9))
 (tile 0 1 0 (set 2))
 (tile 0 2 0 (set 1 2 3 4 5 6 7 8 9))
 (tile 0 3 1 (set 1))
 (tile 0 4 1 (set 7))
 (tile 0 5 1 (set 8))
 (tile 0 6 2 (set 1 2 3 4 5 6 7 8 9))
 (tile 0 7 2 (set 3))
 (tile 0 8 2 (set 1 2 3 4 5 6 7 8 9))
 (tile 1 0 0 (set 1 2 3 4 5 6 7 8 9))
 (tile 1 1 0 (set 4))
 (tile 1 2 0 (set 1 2 3 4 5 6 7 8 9))
 (tile 1 3 1 (set 3))
 (tile 1 4 1 (set 1 2 3 4 5 6 7 8 9))
 (tile 1 5 1 (set 2))
 (tile 1 6 2 (set 1 2 3 4 5 6 7 8 9))
 (tile 1 7 2 (set 9))
 (tile 1 8 2 (set 1 2 3 4 5 6 7 8 9))
 (tile 2 0 0 (set 1))
 (tile 2 1 0 (set 1 2 3 4 5 6 7 8 9))
 (tile 2 2 0 (set 1 2 3 4 5 6 7 8 9))
 (tile 2 3 1 (set 1 2 3 4 5 6 7 8 9))
 (tile 2 4 1 (set 1 2 3 4 5 6 7 8 9))
 (tile 2 5 1 (set 1 2 3 4 5 6 7 8 9))
 (tile 2 6 2 (set 1 2 3 4 5 6 7 8 9))
 (tile 2 7 2 (set 1 2 3 4 5 6 7 8 9))
 (tile 2 8 2 (set 6))
 (tile 3 0 3 (set 1 2 3 4 5 6 7 8 9))
 (tile 3 1 3 (set 1 2 3 4 5 6 7 8 9))
 (tile 3 2 3 (set 8))
 (tile 3 3 4 (set 6))
 (tile 3 4 4 (set 1 2 3 4 5 6 7 8 9))
 (tile 3 5 4 (set 3))
 (tile 3 6 5 (set 5))
 (tile 3 7 5 (set 1 2 3 4 5 6 7 8 9))
 (tile 3 8 5 (set 1 2 3 4 5 6 7 8 9))
 (tile 4 0 3 (set 3))
 (tile 4 1 3 (set 1 2 3 4 5 6 7 8 9))
 (tile 4 2 3 (set 1 2 3 4 5 6 7 8 9))
 (tile 4 3 4 (set 1 2 3 4 5 6 7 8 9))
 (tile 4 4 4 (set 1 2 3 4 5 6 7 8 9))
 (tile 4 5 4 (set 1 2 3 4 5 6 7 8 9))
 (tile 4 6 5 (set 1 2 3 4 5 6 7 8 9))
 (tile 4 7 5 (set 1 2 3 4 5 6 7 8 9))
 (tile 4 8 5 (set 4))
 (tile 5 0 3 (set 1 2 3 4 5 6 7 8 9))
 (tile 5 1 3 (set 1 2 3 4 5 6 7 8 9))
 (tile 5 2 3 (set 6))
 (tile 5 3 4 (set 7))
 (tile 5 4 4 (set 1 2 3 4 5 6 7 8 9))
 (tile 5 5 4 (set 9))
 (tile 5 6 5 (set 2))
 (tile 5 7 5 (set 1 2 3 4 5 6 7 8 9))
 (tile 5 8 5 (set 1 2 3 4 5 6 7 8 9))
 (tile 6 0 6 (set 9))
 (tile 6 1 6 (set 1 2 3 4 5 6 7 8 9))
 (tile 6 2 6 (set 1 2 3 4 5 6 7 8 9))
 (tile 6 3 7 (set 1 2 3 4 5 6 7 8 9))
 (tile 6 4 7 (set 1 2 3 4 5 6 7 8 9))
 (tile 6 5 7 (set 1 2 3 4 5 6 7 8 9))
 (tile 6 6 8 (set 1 2 3 4 5 6 7 8 9))
 (tile 6 7 8 (set 1 2 3 4 5 6 7 8 9))
 (tile 6 8 8 (set 2))
 (tile 7 0 6 (set 1 2 3 4 5 6 7 8 9))
 (tile 7 1 6 (set 8))
 (tile 7 2 6 (set 1 2 3 4 5 6 7 8 9))
 (tile 7 3 7 (set 9))
 (tile 7 4 7 (set 1 2 3 4 5 6 7 8 9))
 (tile 7 5 7 (set 1))
 (tile 7 6 8 (set 1 2 3 4 5 6 7 8 9))
 (tile 7 7 8 (set 6))
 (tile 7 8 8 (set 1 2 3 4 5 6 7 8 9))
 (tile 8 0 6 (set 1 2 3 4 5 6 7 8 9))
 (tile 8 1 6 (set 1))
 (tile 8 2 6 (set 1 2 3 4 5 6 7 8 9))
 (tile 8 3 7 (set 4))
 (tile 8 4 7 (set 3))
 (tile 8 5 7 (set 6))
 (tile 8 6 8 (set 1 2 3 4 5 6 7 8 9))
 (tile 8 7 8 (set 5))
 (tile 8 8 8 (set 1 2 3 4 5 6 7 8 9))) "Testing board to tiles")